(this.webpackJsonpguest_book_front_end=this.webpackJsonpguest_book_front_end||[]).push([[0],{28:function(e,t,a){e.exports=a(47)},33:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(24),o=a.n(r),l=(a(33),a(6)),i=a(7),c=a(9),m=a(8),u=a(14),h=a(5),p=a(48),d=a(50),f=a(52),g=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleLogin=function(){var e=n.props.getUserInfo;fetch("http://localhost:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.state.email,password:n.state.password})}).then((function(e){if(200!==e.status){console.log(e);var t=document.getElementById("warning");throw t.style.display="block",t.innerText="Invalid email or password",t.style.color="red",Error}return e.json()})).then((function(t){n.setState({authorized:!0}),e(t.name,t.email)})).catch((function(e){console.log(e)}))},n.state={email:"",password:"",authorized:!1},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.state.authorized?s.a.createElement(h.a,{to:"/home"}):s.a.createElement(p.a,{style:{width:"30%"}},s.a.createElement("div",null,s.a.createElement(d.a.Group,{controlId:"formBasicEmail"},s.a.createElement(d.a.Label,null,"Email address"),s.a.createElement(d.a.Control,{type:"email",placeholder:"Enter email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})),s.a.createElement(d.a.Group,{controlId:"formBasicPassword"},s.a.createElement(d.a.Label,null,"Password"),s.a.createElement(d.a.Control,{type:"password",placeholder:"Password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),s.a.createElement(f.a,{variant:"primary",type:"button",onClick:this.handleLogin},"Sign in")))}}]),a}(n.Component),E=(a(40),function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleRegister=function(){var e=n.props.getUserInfo;n.state.name.length&&n.state.email.includes("@")&&n.state.password.length&&fetch("http://localhost:5000/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.state.name,email:n.state.email,password:n.state.password})}).then((function(e){return e.json()})).then((function(t){if(t)console.log(t),e(t.name,t.email),n.setState({accepted:!0});else if("email already exists"===t){var a=document.getElementById("warning");a.style.display="block",a.innerText="email already exists",a.style.color="red"}})).catch((function(e){n.setState({accepted:!1})}))},n.state={name:"",email:"",password:"",accepted:!1},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.state.accepted?s.a.createElement(h.a,{to:"/home"}):s.a.createElement(p.a,{style:{width:"30%"}},s.a.createElement("div",null,s.a.createElement(d.a.Group,{controlId:"name"},s.a.createElement(d.a.Label,null,"Name"),s.a.createElement(d.a.Control,{type:"text",placeholder:"Enter Name",value:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),s.a.createElement(d.a.Group,{controlId:"formBasicEmail"},s.a.createElement(d.a.Label,null,"Email address"),s.a.createElement(d.a.Control,{type:"email",placeholder:"Enter email",value:this.state.email,onChange:function(t){e.setState({email:t.target.value})}})),s.a.createElement(d.a.Group,{controlId:"formBasicPassword"},s.a.createElement(d.a.Label,null,"Password"),s.a.createElement(d.a.Control,{type:"password",placeholder:"Password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}})),s.a.createElement(f.a,{variant:"primary",type:"submit",onClick:this.handleRegister},"Register")))}}]),a}(n.Component)),y=a(49),v=a(27),b=a(51);a(41);function j(e){var t=e.resetState,a=e.authenticated,n=e.name,r=e.email;return a?s.a.createElement(y.a,{style:{marginRight:"0px"}},s.a.createElement(v.a,{md:"4",className:"userInfo"},s.a.createElement(b.a,{className:"userCard"},s.a.createElement(b.a.Title,null,s.a.createElement("h4",null,n),s.a.createElement("h5",null,r)))),s.a.createElement(v.a,{className:"Navigation"},s.a.createElement(u.b,{to:"/"},s.a.createElement(f.a,{variant:"light",onClick:function(){return t()}},"Sign Out")))):s.a.createElement(v.a,{className:"Navigation"},s.a.createElement(u.b,{className:"sign",to:"/"},s.a.createElement(f.a,{variant:"light"},"Login")),s.a.createElement(u.b,{className:"sign",to:"/Register"},s.a.createElement(f.a,{variant:"light"},"Register")))}var w=function(e){return fetch("http://localhost:5000/getmessage",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({id:e})}).then((function(e){return e.json()})).then((function(e){return e}))},S=function(e){return fetch("http://localhost:5000/user",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({id:e})}).then((function(e){return e.json()}))},O=(a(42),function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).reply=function(){var e={messageId:n.props.messageInfo._id,name:n.state.name,email:n.state.email,content:n.state.content,replies:n.props.messageInfo.replies};n.props.getMessage(e),n.setState({redirect:!0})},n.delete=function(){fetch("http://localhost:5000/delete",{method:"delete",headers:{"content-type":"application/json"},body:JSON.stringify({id:n.props.messageInfo._id})}).then((function(e){return e.json()})).then((function(e){n.props.refresh()}))},n.edit=function(e){"Save"===e.target.innerText?(n.setState({editMode:!1},(function(){fetch("http://localhost:5000/editmessage",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({id:n.props.messageInfo._id,content:n.state.content})}).then((function(e){return e.json()})).then((function(){n.props.refresh()}))})),e.target.innerText="Edit"):(e.target.innerText="Save",n.setState({editMode:!0}))},n.state={name:"",email:"",content:"",redirect:!1,owner:!1,editMode:!1},n}return Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this;S(this.props.messageInfo.owner).then((function(t){e.setState({name:t.name,email:t.email,content:e.props.messageInfo.content,owner:t.email===e.props.email})}))}},{key:"render",value:function(){var e=this;return this.state.redirect?s.a.createElement(h.a,{to:"/message"}):s.a.createElement(b.a,{className:"message"},s.a.createElement(b.a.Body,null,s.a.createElement(b.a.Title,null,s.a.createElement("h4",null,this.state.name),s.a.createElement("h6",null,this.state.email)),!this.state.editMode&&s.a.createElement(b.a.Text,{className:"content"},this.state.content),this.state.editMode&&s.a.createElement(d.a.Control,{as:"textarea",rows:"2",value:this.state.content,className:"content",onChange:function(t){return e.setState({content:t.target.value})}}),s.a.createElement(y.a,null,s.a.createElement(v.a,null,s.a.createElement(f.a,{variant:"primary",onClick:this.reply},"Reply")),this.state.owner&&s.a.createElement(v.a,{className:"editable"},s.a.createElement(f.a,{className:"",variant:"primary",onClick:this.edit},"Edit"),s.a.createElement(f.a,{className:"",variant:"primary",onClick:this.delete},"Delete")))))}}]),a}(n.Component)),I=(a(43),function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleMessage=function(e){e?fetch("http://localhost:5000/reply",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:n.props.email,content:n.state.message,messageId:n.props.messageId})}).then((function(e){return e.json()})).then((function(e){return n.props.updateMessage(e)})).then(n.setState({message:""})):fetch("http://localhost:5000/message",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({email:n.props.email,content:n.state.message})}).then((function(){n.props.refresh()}))},n.state={message:""},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.reply;return s.a.createElement(p.a,{className:"messageBox"},s.a.createElement(d.a.Group,{controlId:"exampleForm.ControlTextarea1"},s.a.createElement(d.a.Control,{as:"textarea",rows:"3",value:this.state.message,onChange:function(t){e.setState({message:t.target.value})}})),s.a.createElement(f.a,{onClick:function(){return e.handleMessage(t)}},"Write Message"))}}]),a}(n.Component)),C=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).refresh=function(){console.log("refresh",e.state.refresh),fetch("http://localhost:5000/book",{method:"get",headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e.setState({messages:t,refresh:!e.state.refresh})})).then((function(){return window.scrollTo(0,document.body.scrollHeight)}))},e.state={messages:[],refresh:!1},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this;fetch("http://localhost:5000/book",{method:"get",headers:{"content-type":"application/json"}}).then((function(e){return e.json()})).then((function(t){return e.setState({messages:t,refresh:!1})}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(I,{refresh:this.refresh,reply:!1,email:this.props.email}),this.state.messages.map((function(t){return s.a.createElement(O,{email:e.props.email,refresh:e.refresh,messageInfo:t,getMessage:e.props.getMessage})})))}}]),a}(n.Component),N=(a(44),function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).updateReplies=function(t){w(t).then((function(t){S(t.owner).then((function(a){e.setState({replies:e.state.replies.concat([{name:a.name,email:a.email,content:t.content}])})}))}))},e.updateMessage=function(t){e.setState({message:t},(function(){var a=t.replies[t.replies.length-1];e.updateReplies(a)}))},e.state={messageId:"",name:"",email:"",currentUserEmail:"",message:{},replies:[]},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){var e=this;this.setState({messageId:this.props.messageDetails.messageId,currentUserEmail:this.props.email,name:this.props.messageDetails.name,email:this.props.messageDetails.email},(function(){return w(e.state.messageId).then((function(t){e.setState({message:t})})).then((function(){e.state.message.replies.map((function(t){e.updateReplies(t)}))}))}))}},{key:"render",value:function(){return s.a.createElement(p.a,null,s.a.createElement(v.a,null,s.a.createElement(b.a,{className:"message"},s.a.createElement(b.a.Body,null,s.a.createElement(b.a.Title,null,s.a.createElement("h4",null,this.state.name),s.a.createElement("h5",null,this.state.email)),s.a.createElement(b.a.Text,{className:"content"},this.state.message.content)))),this.state.replies.map((function(e){return s.a.createElement(v.a,{md:{span:8,offset:3}},s.a.createElement(b.a,{className:"reply-message"},s.a.createElement(b.a.Body,null,s.a.createElement(b.a.Title,null,s.a.createElement("h4",null,e.name),s.a.createElement("h5",null,e.email)),s.a.createElement(b.a.Text,{className:"content"},e.content))))})),s.a.createElement(v.a,{md:{span:8,offset:3}},s.a.createElement(I,{updateMessage:this.updateMessage,messageId:this.state.messageId,reply:!0,email:this.state.currentUserEmail})))}}]),a}(n.Component)),k=(a(45),{name:"",email:"",authenticated:!1,messageDetails:{}}),M=function(e){Object(c.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).resetState=function(){e.setState(k)},e.getUserInfo=function(t,a){e.setState({name:t,email:a,authenticated:!0})},e.getMessage=function(t){e.setState({messageDetails:t})},e.state=k,e}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement(u.a,null,s.a.createElement(j,{resetState:this.resetState,authenticated:this.state.authenticated,name:this.state.name,email:this.state.email}),s.a.createElement(h.b,{exact:!0,path:"/"},s.a.createElement("div",{className:"login-page"},s.a.createElement(g,{className:"login-form",getUserInfo:this.getUserInfo}),s.a.createElement("div",{style:{display:"none",textAlign:"center"},id:"warning"}))),s.a.createElement(h.b,{path:"/register"},s.a.createElement(E,{getUserInfo:this.getUserInfo}),s.a.createElement("div",{style:{display:"none",textAlign:"center"},id:"warning"})),s.a.createElement(h.b,{path:"/home"},s.a.createElement(C,{email:this.state.email,getMessage:this.getMessage})),s.a.createElement(h.b,{path:"/message"},s.a.createElement(N,{email:this.state.email,messageDetails:this.state.messageDetails})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(46);o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(M,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[28,1,2]]]);
//# sourceMappingURL=main.b1411211.chunk.js.map